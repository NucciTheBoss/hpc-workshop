<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Bringing it all together - HPC Workshop - Ubuntu Summit 2022</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Bringing it all together";
        var mkdocs_page_input_path = "together.md";
        var mkdocs_page_url = null;
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> HPC Workshop - Ubuntu Summit 2022
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Introduction</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../groundwork/">Groundwork</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../ldap/">Setting up our researcher</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../nfs/">Everybody gets some data</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../slurm/">Bureaucracy and nodes</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../lmod/">Where is the software?</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../containers/">Getting fancy with containers</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../spack/">Better software management with Spack</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="./">Bringing it all together</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#writing-a-job">Writing a job</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#submitting-a-job">Submitting a job</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#evaluating-the-results">Evaluating the results</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../future/">Where to go from here?</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">HPC Workshop - Ubuntu Summit 2022</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
      <li>Bringing it all together</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="time-to-enjoy-the-fruits-of-your-labor">Time to enjoy the fruits of your labor</h1>
<p>We have gone through all this work to set up our cluster, so now it is time for us to enjoy the fruits of our labor.
We are going to use all the software we have set up to submit our first job.</p>
<h2 id="writing-a-job">Writing a job</h2>
<p>Log into the <code>head-0</code> as user <code>test</code>:</p>
<pre><code class="language-text">$ lxc shell head-0
~# sudo -i -u nucci
</code></pre>
<p>Logged in as user <code>test</code>, open a text editor window:</p>
<pre><code class="language-text">$ nano research.submit
</code></pre>
<p>With the file <em>research.submit</em> open, populate the file with the content below:</p>
<pre><code class="language-text">#!/bin/bash
#SBATCH --job-name=research
#SBATCH --partition=all
#SBATCH --nodes=1
#SBATCH --ntasks-per-node=1
#SBATCH --cpus-per-task=1
#SBATCH --mem=500mb
#SBATCH --time=00:00:30
#SBATCH --error=research.%J.err
#SBATCH --output=research.%J.out

. spack/share/spack/setup-env.sh
spack load cowsay
module load apptainer

apptainer -s run cobol-runtime.sif
echo -e &quot;\n\n&quot;
cowsay 'Done'
</code></pre>
<p>Save and close the file once you are done populating the <em>research.job</em> file.</p>
<blockquote>
<p><strong>Important:</strong> If you notice that your SLURM compute node has the state of drained, you will need to <em>undrain</em> it.
You can undrain the node by launching the scontrol interpreter and issuing the following commands:
<code>text
~# scontrol
update NodeName=compute-0 State=DOWN Reason="undraining"
update NodeName=compute-0 State=RESUME</code></p>
</blockquote>
<h2 id="submitting-a-job">Submitting a job</h2>
<p>You can use the following command to submit your job file to your micro-HPC cluster:</p>
<pre><code class="language-text">$ sbatch research.submit
</code></pre>
<h2 id="evaluating-the-results">Evaluating the results</h2>
<p>After a few seconds, your job's results should be returned by SLURM. You can use the following command to browse
through the results of your job:</p>
<pre><code class="language-text">$ less research.65539.out
</code></pre>
<blockquote>
<p><strong>Note:</strong> Your job ID number may defer from the one above.</p>
</blockquote>
<p>You should see something like the following in your <code>less</code> window:</p>
<pre><code class="language-text">1ST RESULT : +445.62
2ND RESULT : -123.45
3RD RESULT : XYZ   
4TH RESULT : M565$
SUMMARY: ATOMS CHEMICALS OH MY 



 ______ 
&lt; Done &gt;
 ------ 
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
</code></pre>
<p>Congratulations! You successfully ran your first job. This is the end of the workshop, so the next page will discuss
where you can go from here!</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../spack/" class="btn btn-neutral float-left" title="Better software management with Spack"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../future/" class="btn btn-neutral float-right" title="Where to go from here?">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../spack/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../future/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
      <script src="../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
